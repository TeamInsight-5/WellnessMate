<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>외과 응급도 평가</title>
    <link rel="stylesheet" th:href="@{/css/surgery.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=48475be29fda82ad232749bbb6f73ea1&libraries=services"></script>
</head>
<body>

<div class="main-wrapper">
    <header class="page-header">
        <div class="header-icon">✂️</div>
        <h1>외과 상담</h1>
        <p>외상 및 응급상황 평가를 통해 적절한 응급처치와 의료 서비스를 안내받으세요</p>
    </header>

    <div class="content-container">

        <main class="survey-container card">
            <div class="progress-bar-container">
                <span>응급도 평가 진행률</span>
                <div class="progress-bar">
                    <div class="progress" style="width: 20%;"></div>
                </div>
                <span class="step-text">1/5</span>
            </div>

            <div id="step1" class="survey-step">
                <h2>어떤 종류의 외상을 입으셨나요?</h2>
                <form class="options-group">
                    <label><input type="checkbox" name="injuries" value="cut"><span>칼이나 날카로운 물체에 베임</span></label>
                    <label><input type="checkbox" name="injuries" value="burn"><span>화상</span></label>
                    <label><input type="checkbox" name="injuries" value="fall"><span>낙상/추락</span></label>
                    <label><input type="checkbox" name="injuries" value="fracture"><span>골절 의심</span></label>
                </form>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary btn-prev">이전</button>
                    <button type="button" class="btn btn-primary btn-next">다음</button>
                </div>
            </div>

            <div id="step2" class="survey-step" style="display: none;">
                <h2>외상 부위 사진을 촬영하여 AI 분석을 받아보세요 <small>(선택사항)</small></h2>
                <div class="notice-box info"><i class="fa-solid fa-shield-halved"></i><div><strong>개인정보 보호 안내</strong><p>업로드된 사진은 진단 목적으로만 사용되며, 분석 완료 후 즉시 삭제됩니다.</p></div></div>
                <div class="upload-buttons-container">
                    <button class="btn btn-primary btn-upload"><i class="fa-solid fa-upload"></i> 사진 업로드</button>
                    <button class="btn btn-secondary btn-camera"><i class="fa-solid fa-camera"></i> 카메라 촬영</button>
                </div>
                <div class="drag-drop-area"><i class="fa-solid fa-file-arrow-up"></i><p>사진을 여기로 드래그하세요</p><small>JPG, PNG (최대 10MB)</small></div>
                <div class="button-group step2-buttons">
                    <button type="button" class="btn btn-secondary btn-prev">이전</button>
                    <button type="button" class="btn btn-secondary btn-skip">건너뛰기</button>
                    <button type="button" class="btn btn-primary btn-next">다음</button>
                </div>
            </div>

            <div id="step3" class="survey-step" style="display: none;">
                <h2>출혈의 정도는 어떠한가요?</h2>
                <form class="options-group">
                    <label><input type="radio" name="bleeding" value="none"><span>출혈 없음</span></label>
                    <label><input type="radio" name="bleeding" value="slight"><span>약간의 출혈 (자연 지혈 가능)</span></label>
                    <label><input type="radio" name="bleeding" value="continuous"><span>지속적인 출혈 (압박 필요)</span></label>
                    <label><input type="radio" name="bleeding" value="severe"><span>심한 출혈 (멈추지 않음)</span></label>
                </form>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary btn-prev">이전</button>
                    <button type="button" class="btn btn-primary btn-next">다음</button>
                </div>
            </div>

            <div id="step4" class="survey-step" style="display: none;">
                <h2>통증과 움직임은 어떠한가요?</h2>
                <form class="options-group">
                    <label><input type="radio" name="pain" value="mild"><span>가벼운 통증, 움직임 가능</span></label>
                    <label><input type="radio" name="pain" value="moderate"><span>보통 통증, 움직임 제한</span></label>
                    <label><input type="radio" name="pain" value="severe"><span>심한 통증, 움직임 불가</span></label>
                    <label><input type="radio" name="pain" value="unconscious"><span>의식 잃음</span></label>
                </form>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary btn-prev">이전</button>
                    <button type="button" class="btn btn-primary btn-next">다음</button>
                </div>
            </div>

            <div id="step5" class="survey-step" style="display: none;">
                <h2>현재 상태를 확인해주세요</h2>
                <form class="options-group">
                    <label><input type="checkbox" name="status" value="respiratory_distress"><span>호흡 곤란</span></label>
                    <label><input type="checkbox" name="status" value="weak_pulse"><span>약한 맥박</span></label>
                    <label><input type="checkbox" name="status" value="decreased_consciousness"><span>의식 저하</span></label>
                </form>
                <div class="button-group">
                    <button type="button" class="btn btn-secondary btn-prev">이전</button>
                    <button type="button" class="btn btn-primary btn-submit">응급도 평가</button>
                </div>
            </div>

            <div id="result" class="survey-step" style="display: none;">
                <h2>응급도 평가 결과</h2>
                <div class="result-box card">
                    <span id="riskLevel" class="risk-level"></span>
                    <p class="score-text">응급도 점수 <span id="scoreValue"></span></p>
                    <div class="score-bar"><div class="score-progress" id="scoreProgress"></div></div>
                    <p class="emergency-message" id="emergencyMessage"></p>
                    <p class="emergency-guide" id="emergencyGuide"></p>
                </div>
                <div class="detail-result-section">
                    <h4>상세 평가 결과</h4>
                    <div id="detailResultList"></div>
                </div>
                <div class="recommendation-section">
                    <h4>추천 진료과</h4>
                    <div id="recommendedDepartments"></div>
                </div>
                <div class="button-group">
                    <button type="button" class="btn btn-primary" onclick="restartSurvey()">다시 평가하기</button>
                </div>
            </div>
        </main>

        <aside class="emergency-guide-container card">
            <div id="guide-default">
                <h4>응급상황 대응 가이드</h4>
                <div class="guide-section urgent"><h5><i class="fa-solid fa-bolt"></i> 즉시 119 신고가 필요한 경우</h5><ul><li>의식을 잃은 경우</li><li>심한 출혈이 멈추지 않는 경우</li><li>호흡곤란이 있는 경우</li><li>척추 손상이 의심되는 경우</li></ul></div>
                <div class="guide-section aid"><h5><i class="fa-solid fa-circle-exclamation"></i> 기본 응급처치 원칙</h5><ul><li>환자와 주변 안전 확보</li><li>출혈 부위 직접 압박</li><li>골절 부위 움직이지 않게 고정</li><li>환자를 따뜻하게 보온</li></ul></div>
                <div class="guide-section info"><h5><i class="fa-solid fa-chart-line"></i> 정확한 응급도 평가</h5><p>외상의 종류, 출혈, 의식 상태 등을 종합 평가하여 적절한 응급 대응을 결정합니다.</p></div>
            </div>
            <div id="guide-step2" style="display: none;">
                <h4>AI 사진 분석</h4>
                <div class="guide-section info"><h5><i class="fa-solid fa-robot"></i> AI 사진 분석의 장점</h5><ul><li>화상의 크기와 깊이 정량적 측정</li><li>상처 종류의 자동 분류</li><li>감염 위험도 평가</li></ul></div>
                <div class="guide-section aid"><h5><i class="fa-solid fa-notes-medical"></i> 분석 가능한 외상 유형</h5><ul><li>찰과상, 열상, 자상</li><li>화상, 골절, 타박상</li></ul></div>
            </div>
        </aside>
    </div>

    <div class="nearby-hospital-section card">
        <div class="container-header">
            <h4>주변 응급 병원 찾기</h4>
        </div>
        <div id="map-container"></div>
        <div id="nearby-hospitals-list" class="hospital-grid"></div>
    </div>
</div>

<script th:src="@{/js/surgery.js}"></script>
</body>
</html>