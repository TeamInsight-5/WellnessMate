<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8">
    <title>주변 내과 병원 조회</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        /* 병원 카드 레이아웃 */
        .hospital-container {
            display: flex;
            flex-wrap: wrap; /* 줄 바꿈 가능 */
            gap: 16px; /* 카드 사이 간격 */
            margin-top: 20px;
        }

        .hospital-card {
            flex: 1 1 calc(50% - 16px); /* 가로 2개씩 */
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 12px;
            box-sizing: border-box;
            background-color: #f9f9f9;
            transition: transform 0.2s;
        }

        .hospital-card:hover {
            transform: scale(1.03); /* 마우스 오버 시 살짝 확대 */
        }

        .error-msg {
            color: red;
        }

        /* 모바일 대응: 화면이 좁으면 1개씩 */
        @media (max-width: 600px) {
            .hospital-card {
                flex: 1 1 100%;
            }
        }

        /* 입력창과 버튼 */
        #address {
            width: 300px;
            padding: 8px;
        }

        #searchBtn {
            padding: 8px 12px;
        }
    </style>
</head>
<body>
<div th:replace="~{mainPage:: header}"></div>
<h1>주변 내과 병원 조회</h1>

<div>
    <input type="text" id="address" placeholder="주소를 입력하세요">
    <button id="searchBtn">검색</button>
</div>

<div id="result" class="hospital-container">
    <!-- 병원 카드 출력 -->
</div>

<div th:replace="~{mainPage:: footer}"></div>

<script>
    $(document).ready(function() {
        $('#searchBtn').click(function() {
            const address = $('#address').val().trim();
            if (!address) {
                alert("주소를 입력해주세요.");
                return;
            }

            $.ajax({
                url: '/api/map/hospitals',
                method: 'GET',
                data: { address: address },
                success: function(data) {
                    if (data.length === 0) {
                        $('#result').html("<p>검색 결과가 없습니다.</p>");
                        return;
                    }

                    let html = '';
                    data.forEach(hospital => {
                        html += `
                            <div class="hospital-card">
                                <strong>${hospital.place_name}</strong><br>
                                ${hospital.road_address_name}
                            </div>
                        `;
                    });
                    $('#result').html(html);
                },
                error: function(err) {
                    console.error(err);
                    $('#result').html("<p class='error-msg'>병원 조회 중 오류가 발생했습니다.</p>");
                }
            });
        });
    });
</script>
</body>
</html>